2025.5.13修改内容：

1. 节点多维度AI/ML预测与评分
功能说明：

节点的未来表现预测采用多特征线性回归，综合延迟、丢包、带宽、历史分数等多维数据，预测未来一段时间的延迟、丢包和风险。
AI评分函数（aiScoreNode）对每个节点的实时表现进行多因子加权打分，分数越低代表节点越优质。
原理解释：

线性回归通过历史数据点拟合趋势，能更科学地预测节点未来表现，避免单一均值或极端值误导。
多因子加权评分兼顾了延迟、抖动、丢包、带宽、历史表现等，能更全面反映节点真实质量。

2. 节点优质/劣质状态与自适应评估周期
功能说明：

节点每30分钟自动评估一次质量，连续多次优/劣会自动延长下次评估周期（指数增长），最长可达24小时。
优质节点优先权重显著提升，劣质节点权重极低，优质节点更易被选中。
原理解释：

指数增长的评估周期可减少对稳定优质节点的频繁打扰，提升整体网络稳定性。
权重机制保证优质节点在分流和切换时始终拥有更高优先级。

3. 节点切换冷却与方向性
功能说明：

节点切换冷却时间随优质次数递增，最长24小时，避免频繁切换。
切换逻辑始终向AI评分更高、风险更低的优质节点靠拢，只有新节点显著优于当前节点才会切换。
原理解释：

冷却机制防止因网络波动导致的频繁切换，提升连接稳定性。
方向性切换保证网络始终趋向最优状态，避免无意义的来回切换。

4. 节点异常检测与自动降级/恢复
功能说明：

节点异常概率预测（如未来丢包、不可用）自动标记高风险节点为“bad”，低风险节点为“good”。
节点异常时自动降级，恢复后自动提升优先级，无需人工干预。
原理解释：

异常检测基于滑动窗口统计和AI预测，能及时发现并规避不稳定节点。
自动降级/恢复机制保证分流和切换始终优先健康节点。

5. 全流程自动化与自学习
功能说明：

节点切换、分流、优选、降级、学习等全部自动化，无需人工干预。
节点表现预测、分流表调整、异常预警等全部自动驱动，主流程统一调度。
原理解释：

自动化和自学习机制让系统能根据实时数据自我优化，适应网络环境变化，持续提升整体表现。

6. 结构优化与可维护性提升
功能说明：

所有AI/ML预测、评分、切换、分流等核心逻辑集中封装，参数、权重、阈值集中配置。
冗余、重复、无效代码已清理，主流程调用链清晰，便于后续维护和扩展。
原理解释：

结构优化减少维护成本，集中配置便于调优和升级，代码更易理解和扩展。


clash verge re&mihomo party全局覆写，懒人一键全自动脚本

给Clash-Verge-Rev和Mihomo-Party做的全自动智能脚本，复制粘贴或者导入即可，不需要任何额外人工操作

引用自https://github.com/dahaha-365/YaNet/

感谢dahaha-365的源代码技术，，进行了相关源代码重构

功能简介：

1. 全局开关控制
功能：通过 enable 变量一键启用或禁用整个脚本的所有功能。

原理：在主流程中判断 enable，为 false 时直接返回原始配置，不做任何处理。

2. CDN 智能调度与健康检测
功能：自动选择最优 CDN 源，动态切换、健康检查、丢包/延迟/历史成功率统计，避免因 CDN 不稳定导致规则集加载失败。

原理：
维护多个 CDN 源列表，定期健康检查（TCP/UDP 探测+HTTP 检查）。
统计每个 CDN 的延迟、丢包、历史成功率，动态调整阈值。
采用多维度评分和冷却机制，智能切换 CDN 源。

3. 节点健康检测与测速缓存
功能：对所有代理节点进行多维度健康检测（延迟、丢包、抖动、带宽），并缓存测速结果，自动自愈异常节点。

原理：
并发多次测速，统计平均延迟、丢包率、抖动等。
维护节点健康缓存，连续多次异常自动标记为不健康，健康节点优先分流。
节点自愈：异常节点冷却后自动重试，恢复后重新纳入分流。

4. 节点多维度智能优选与分组
功能：根据延迟、丢包、抖动、历史表现等多维度综合评分，自动优选最优节点，并支持地理聚类分组。

原理：
对每个分组内节点批量测速，按加权评分排序，最优节点自动排首位。
支持地理信息聚类（预留接口），可扩展为按地区/用途分组。

5. 地区分组与倍率过滤
功能：通过正则匹配节点名称自动分组（如香港、日本、美国等），并可排除高倍率节点，提升分流准确性。

原理：
配置地区分组及对应正则，自动筛选符合地区且倍率低于阈值的节点。
每个地区生成独立策略组，便于流量按地区分流。

6. 规则集自动生成与多源下载
功能：自动生成分流规则，支持多种主流规则集（ACL4SSR、Loyalsoldier、DivineEngine、Blackmatrix7等），并支持多 CDN 源下载与校验。

原理：
维护规则集提供者 Map，自动拼接 CDN 地址和本地缓存路径。
支持规则集哈希校验和签名验证，确保规则集完整性和安全性。

7. DNS 智能配置与分流
功能：自动配置国内外 DNS，支持 DoH/DoT/EDNS 子网、DNS 缓存、热门域名预热、GeoIP 分流等。

原理：
国内外 DNS 自动分流，支持加密 DNS。
DNS 缓存、预取、持久化，提升解析速度。
支持 fake-ip、EDNS 子网、GeoIP 规则，提升分流准确性。

8. 代理组自动生成与分流增强
功能：根据节点分组和规则自动生成多种策略组（如国外流量、默认节点、各地区、流媒体、游戏、AI、广告过滤等），并自动优化分组顺序。

原理：
自动生成 select/load-balance 类型策略组，按优选节点排序。
支持 QoS、健康检查、负载均衡、权重调整等高级选项。

9. 规则与策略组动态扩展
功能：根据用户配置自动启用/禁用各类规则和策略组（如 YouTube、Netflix、AI、广告、追踪等）。

原理：
通过 ruleOptions 控制各类规则和分组的启用状态，自动生成对应规则和策略组。

10. 缓存与性能优化
功能：多处采用 LRU 缓存、预取、懒清理、批量并发等机制，提升性能和响应速度。

原理：
访问高频项自动预取，缓存过期自动清理，批量操作并发执行。

11. 流量模式识别与动态分配
功能：根据流量类型（视频、游戏、网页等）动态分配最优节点，提升体验。

原理：
简单流量统计与模式识别，按类型优选节点分配。

12. 配置文件自动增强与兼容性处理
功能：自动增强原始配置（如开启 LAN、优化 NTP、Geo 数据、Sniffer、Profile 等），兼容 Mihomo/Clash 生态。

原理：
自动补全和优化配置项，提升兼容性和易用性。

13. 规则集签名校验与安全性提升
功能：支持规则集签名校验和哈希校验，防止规则被篡改。

原理：
下载规则集后校验签名或哈希，校验失败则警告或拒绝加载。

14. 入口函数与自动化流程
功能：main(config) 为主入口，自动处理配置文件，生成最终增强版配置。
原理：
读取原始配置，按上述所有逻辑自动处理，返回增强后的配置对象。
