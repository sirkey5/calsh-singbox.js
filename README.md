给clash做全局覆写，给singbox做配置混入的脚本
具体内容为：

一、核心功能模块

1. 节点健康监测系统
- 三协议混合探测（TCP/UDP/HTTP）
- 动态超时机制：基于RTT和抖动计算基础超时时间（200ms~3s）
- 智能滤波处理：采用EMA算法平滑网络波动
- 实时指标收集：延迟、丢包率、抖动等
2. 智能调度算法
- 动态权重计算：基于网络质量趋势自动调整各指标权重
- 多维度评估体系：
  • 实时成功率（60%权重）
  • 历史衰减数据（25%权重）
  • 网络抖动系数（15%权重）
3. 故障处理机制
- 分级熔断策略：
  │ 普通节点：3次失败切换
  │ 优质节点：评分下降50%触发保护
- 智能隔离系统：
  • 基础隔离时长24小时
  • 动态隔离系数（0.5~1.5倍）基于节点稳定性

一、核心功能模块

1. 节点健康监测系统
- 三协议混合探测（TCP/UDP/HTTP）
- 动态超时机制：基于RTT和抖动计算基础超时时间（200ms~3s）
- 智能滤波处理：采用EMA算法平滑网络波动
- 实时指标收集：延迟、丢包率、抖动等
2. 智能调度算法
- 动态权重计算：基于网络质量趋势自动调整各指标权重
- 多维度评估体系：
  • 实时成功率（60%权重）
  • 历史衰减数据（25%权重）
  • 网络抖动系数（15%权重）
3. 故障处理机制
- 分级熔断策略：
  │ 普通节点：3次失败切换
  │ 优质节点：评分下降50%触发保护
- 智能隔离系统：
  • 基础隔离时长24小时
  • 动态隔离系数（0.5~1.5倍）基于节点稳定性
  
二、关键技术实现

1. 质量评估算法
// 节点稳定性评分计算公式
score = (SR * 0.6) + (HS * 0.25 * TDF) + (JQ * 0.15) 
// SR: 实时成功率, HS: 历史衰减数据, TDF: 时间衰减因子, JQ: 网络抖动系数

2. 动态权重调整
// 基于网络质量趋势的权重计算（示例）
_getTrafficFactor(metricType) {
  const successTrend = /* 成功率趋势分
  析 */;
  const latencyTrend = /* 延迟变化率 
  */;
  return baseWeight * (1 + Math.tanh
  (successTrend - latencyTrend));
}

3. 探测优化机制
- 协议差异化超时：
  TCP超时 = 基础超时 * 1.2 * √(平滑RTT/基准RTT)
  UDP超时 = 基础超时 * 0.8 * (1 + RTT标准差/基准RTT)

4. 数据存储结构

// 使用分层存储优化内存使用
fullWindow: 保存最近100条全量数据
sampledWindow: 每10条采样1条存储900条

三、特色功能

1. 优质节点保护机制
- 自动标记评分>85%的节点
- 触发条件：成功率>90%且延迟<150ms
- 保护期动态调整（1~24小时）
2. 网络质量感知
- 实时计算网络质量衰减系数：
  QDF = e^(-Δt/历史窗口)
- 动态调整探测频率（300~600秒）
3. 异常处理策略
- 分级恢复机制：
  │ 临时故障：5分钟冷却
  │ 持续故障：指数退避重试
  │ 硬件故障：24小时隔离
